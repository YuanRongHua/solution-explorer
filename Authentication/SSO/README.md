
# SSO 单点登录
## 实现流程：
单点登录指的是在公司内部搭建一个公共的认证中心，公司下的所有产品的登录都可以在认证中心里完成，一个产品在认证中心登录后，再去访问另一个产品，可以不用再次登录，即可获取登录状态。

首次访问：  
1.用户访问网站 a.com 下的 pageA 页面。  
2.由于没有登录，则会302重定向到认证中心，并带上回调地址 www.sso.com?return_uri=a.com/pageA，以便登录后直接进入对应页面。  
3.用户在认证中心输入账号密码，提交登录。  
4.认证中心验证账号密码有效，然后重定向 a.com?ticket=123 带上授权码 ticket，并将认证中心 sso.com 的登录态写入 Cookie。  
5.在 a.com 服务器中，拿着 ticket 向认证中心确认，授权码 ticket 真实有效。  
6.验证成功后，服务器将登录信息写入 Cookie（此时客户端有 2 个 Cookie 分别存有 a.com 和 sso.com 的登录态）。  

认证中心登录完成之后，继续访问 a.com 下的其他页面，由于 a.com 存在已登录的 Cookie 信息，所以服务器端直接认证成功。  

再访问 b.com 下的页面：
这个时候，由于认证中心存在之前登录过的 Cookie，所以也不用再次输入账号密码，直接返回第 4 步，下发 ticket 给 b.com 即可。

## SSO 单点登录退出：  
当某个产品 c.com 退出登录时：  
1.清空 c.com 中的登录态 Cookie。  
2.请求认证中心 sso.com 中的退出 api。   
3.认证中心遍历下发过 ticket 的所有产品，并调用对应的退出 api，完成退出。 
